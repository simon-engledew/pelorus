digraph "<%= sanitize_label(map.name) %>" {
  compound=true;
  truecolor=true;
  size="9,100";
  rankdir=BT;
  graph [truecolor bgcolor="transparent"];
  node [shape=box];
  pad=0.25;
  node [
    fontname="Helvetica",
    fontsize="10",
    penwidth="2",
    style="filled",
  ];
  URL="<%= polymorphic_url(map) %>";
  
  <%= render :partial => 'network_goal', :collection => map.children -%>

  <%- map.goals.each do |goal| -%>
    <%- goal.supporting_goals.each do |supporting_goal| -%>
      goal_<%= cluster_target(supporting_goal.supported_by).id %> -> goal_<%= cluster_target(supporting_goal.goal).id %> [
        style=<%= supporting_goal.supported_by.propagate ? 'solid' : 'dotted' %>,
        color="<%= line_color(supporting_goal.supported_by.status) %>",
        penwidth="2",
        <% unless supporting_goal.supported_by.children.empty? and supporting_goal.goal.children.empty? %>
        label=" ",
        <% end %>
        <% unless supporting_goal.supported_by.children.empty? %>ltail="cluster_<%= supporting_goal.supported_by.id %>",<% end %>
        <% unless supporting_goal.goal.children.empty? %>lhead="cluster_<%= supporting_goal.goal.id %>",<% end %>
      ];
    <%- end -%>
  <%- end -%>
}
